---
title: "Stats 102A - Homework 2 - Output File"
author: "Sesha Chalamalasetti"
output: pdf_document
---

Homework questions and prompts copyright Miles Chen, Do not post, share, or distribute without permission.

To receive full credit the functions you write must pass all tests. We may conduct further tests that are not included on this page as well.

# Academic Integrity Statement

By including this statement, I, Sesha Chalamalasetti, declare that all of the work in this assignment is my own original work. At no time did I look at the code of other students nor did I search for code solutions online. I understand that plagiarism on any single part of this assignment will result in a 0 for the entire assignment and that I will be referred to the dean of students.


```{r, error = TRUE}
source("102a_hw_02_script_Sesha_Chalamalasetti.R")  # edit with your file name
```

\pagebreak

# Part 1: Board representation

Create a single list object called `board` where you store the features of the game board in R.

```{r, error = TRUE}
# first argument is rows, second argument is columns, 3rd argument is vector of to and from values for ladders and 4th argument is vector of to and from values for chutes

dim1 <- 10
dim2 <- 10
ladders <- c(1,38,21,42,4,14,9,31,36,44,28,84,51,67,71,91,80,100)
chutes <- c(16,6,49,11,47,26,56,53,62,19,64,60,87,24,93,73,95,75,98,78)

board <- list(dim1,dim2, ladders, chutes)
```

\pagebreak

# Part 2: Plot of Game board

```{r, error = TRUE}
# par() should help the plot be more visible. you can adjust this as necessary
par(mar = c(0, 0, 0, 0)) 
show_board(board)
```

\pagebreak

# Part 3: Miniboards

Create the `miniboard` objects and plots.

```{r, error = TRUE}
# Dimensions: 6 col x 7 row
# ladders: 1 to 23, 9 to 27, 20 to 31, 33 to 41
# chutes: 16 to 6, 30 to 18, 35 to 24, 40 to 26

dim1 <-7
dim2 <- 6
ladders <- c(1,23,9,27,20,31,33,41)
chutes <- c(16,6,30,18,35,24,40,26)

miniboard1 <- list(dim1,dim2, ladders, chutes)
par(mar = c(0, 0, 0, 0))
show_board(miniboard1)
```

```{r, error = TRUE}
# Dimensions: 7 col x 9 rows
# ladders: 9 to 22, 13 to 30, 24 to 37, 29 to 41, 33 to 39, 43 to 54
# chutes: 16 to 3, 31 to 15, 35 to 21, 62 to 48

dim1 <- 9
dim2 <- 7
ladders <- c(9,22,13,30,24,37,29,41,33,39,43,54)
chutes <- c(16,3,31,15,35,21,62,48)

miniboard2 <- list(dim1,dim2, ladders, chutes)
par(mar = c(0, 0, 0, 0))
show_board(miniboard2)
```

```{r, error = TRUE}
# Dimensions: 8 col x 9 rows
# ladders: none
# chutes: none

dim1 <- 9 
dim2 <- 8
ladders <- list()
chutes <- list()
miniboard3 <- list(dim1, dim2, ladders, chutes )

par(mar = c(0, 0, 0, 0))
show_board(miniboard3)
```

\pagebreak

# Part 4: Verbose output of one single player game

```{r, error = TRUE}
set.seed(5)
play_solo(board, verbose = TRUE)
```

\pagebreak

# Part 5: Monte Carlo Simulation Study

```{r, error = TRUE}
# run 10,000 games
large <- replicate(10000, play_solo(board, FALSE))
```


- Create a histogram (breaks = 50) of the turns.

```{r}
turns <- unlist(large[1, ])
hist(turns, breaks = 50, main = "Histogram of Number of Turns Across 10,000 Games", xlab = "Number of Turns")
```


- Find the minimum number of turns. How many times out of 10,000 did a game finish with the minimum number of turns?

```{r}
min(turns)
length(turns[turns == min(turns)])
```

- Find the maximum number of turns.
```{r}
max(turns)
```


- What is the median number of turns?
```{r}
median(turns)
```

- What is the mean number of turns?
```{r}
mean(turns)
```

- What proportion of games take 100 or more turns to complete?
```{r}
subset1 <- turns[turns >= 100]
length(subset1)/length(turns)
```

- What proportion of games take 10 or fewer turns to complete?
```{r}
subset2 <- turns[turns <= 10]
length(subset2)/length(turns)
```

- What proportion of games utilize ladder 9 (the shortcut to win on space 80)?
```{r}
all_nines <- c()
ladder_values <- large[3, ]
for(i in 1:length(ladder_values)) { 
  input <- ladder_values[[i]][9]
  all_nines <- c(all_nines, input)
  }

utilize <- all_nines[all_nines > 0]

length(utilize)/length(all_nines)
```

- Create a barplot of the relative frequency of how often each chute is utilized. (Number the chutes in order
based on their starting square. The chute with lowest starting number, 16 to 6, is chute 1. The chute going
from 98 to 78 is chute 10.)
```{r}
chute_values <- large[2, ]
chute_numbers <- 1:length(chute_values[[1]])
chute_sums <- c()

for(j in 1: length(chute_values[[1]])) { 
  chute_i <- c() # redefine chute_i 
  for (i in 1: length(chute_values)) { 
    input <- chute_values[[i]][j]
    chute_i <- c(chute_i, input)
    }
  sum_i <- sum(chute_i)
  chute_sums <- c(chute_sums, sum_i)
  }

chute_frequencies <- (chute_sums/sum(chute_sums))
df_chute <- data.frame(chute_frequencies)
  
barplot(height = t(as.matrix(df_chute)), names = chute_numbers, xlab = "Chute Number", ylab = "Relative Frequency", ylim = c(0, 0.20), beside = TRUE)

```
- Create a barplot of the relative frequency of how often each ladder is utilized. (Number the ladders in order
based on their starting square. The ladder with lowest starting number, 1 to 38, is ladder 1. The Ladder going
from 80 to 100 is ladder 9.)

```{r}
ladder_numbers <- 1:length(ladder_values[[1]])
ladder_sums <- c()

for(j in 1: length(ladder_values[[1]])) { 
  ladder_i <- c() # redefine chute_i 
  for (i in 1: length(ladder_values)) { 
    input <- ladder_values[[i]][j]
    ladder_i <- c(ladder_i, input)
    }
  ladder_i <- sum(ladder_i)
  ladder_sums <- c(ladder_sums, ladder_i)
  }

ladder_frequencies <- (ladder_sums/sum(ladder_sums))
df_ladder <- data.frame(ladder_frequencies)
  
barplot(height = t(as.matrix(df_ladder)), names = ladder_numbers, xlab = "Ladder Number", ylab = "Relative Frequency", ylim = c(0, 0.20), beside = TRUE)

```
```{r, eval = TRUE, out.height="100%"}
library(knitr)
knitr::include_graphics("documentation_HW2.pdf")
```


